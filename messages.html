{% extends "base.html" %}

{% block title %}Мои сообщения - Вакансионный сайт{% endblock %}

{% block content %}
    <h2>Мои сообщения</h2>
    
    <div class="message-tabs">
        <button class="tab-button active" onclick="openTab(event, 'received-messages')">Входящие</button>
        <button class="tab-button" onclick="openTab(event, 'sent-messages')">Отправленные</button>
    </div>
    
    <div id="received-messages" class="tab-content" style="display: block;">
        {% if received_messages %}
            {% for message in received_messages %}
                <div class="message {% if not message.is_read %}unread{% endif %}">
                    <div class="message-header">
                        <strong>От:</strong> {{ message.sender.username }}
                        <span class="date">{{ message.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
                    </div>
                    <div class="message-vacancy">
                        По вакансии: <a href="{{ url_for('vacancy_details', vacancy_id=message.vacancy.id) }}">{{ message.vacancy.title }}</a>
                    </div>
                    <div class="message-content">
                        {{ message.content }}
                    </div>
                    <div class="message-actions">
                        <a href="{{ url_for('send_message', vacancy_id=message.vacancy.id) }}" class="button small">Ответить</a>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>У вас нет входящих сообщений.</p>
        {% endif %}
    </div>
    
    <div id="sent-messages" class="tab-content">
        {% if sent_messages %}
            {% for message in sent_messages %}
                <div class="message">
                    <div class="message-header">
                        <strong>Кому:</strong> {{ message.recipient.username }}
                        <span class="date">{{ message.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
                    </div>
                    <div class="message-vacancy">
                        По вакансии: <a href="{{ url_for('vacancy_details', vacancy_id=message.vacancy.id) }}">{{ message.vacancy.title }}</a>
                    </div>
                    <div class="message-content">
                        {{ message.content }}
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>У вас нет отправленных сообщений.</p>
        {% endif %}
    </div>
{% endblock %}